# **8.2.Jacobi矩阵与全微分**

---

## **2.1.向量集映射与Jacobi矩阵**

考虑向量集函数$\mathbf{z}=f(\mathbf{v})，\mathbf{v}=(x,y)^{\mathbf{T}}$在$(x_0,y_0)$处微分：

$$
f(\mathbf v+\mathbf h)-f(\mathbf v)=J\cdot\mathbf h+o(||\mathbf h||)，\mathbf h \to \mathbf 0
$$

其中$o(||\mathbf h||)$为$||\mathbf h||$的高阶无穷小，因此$f(\mathbf v)$在$(x_0,y_0)$处任意方向$\mathbf h$的增量可近似于增量$\mathbf h$的线性函数：

$$
\text{d}f(\mathbf v)=J\cdot\mathbf h
$$

对于更为具体的向量集函数$F(x,y)=(P(x,y),Q(x,y))^{\mathbf T}$，其微分可表示为：

$$
\text{d}F(x,y)=
\begin{pmatrix}
 \text{d}P\\
 \text{d}Q
\end{pmatrix}
=\begin{pmatrix}
 \nabla P\\
 \nabla Q
\end{pmatrix}\cdot\mathbf h=
\begin{pmatrix}
 P_x & P_y\\
 Q_x & Q_y
\end{pmatrix}\cdot\mathbf{h}
$$

因此我们确定二维向量集函数$\mathbf{z}=f(\mathbf{v})$的Jacobi矩阵：

$$
J=\begin{pmatrix}
 P_x & P_y\\
 Q_x & Q_y
\end{pmatrix}
$$

对于二维值函数$z=f(x,y)$，有$\text{d}z=\nabla f\cdot\mathbf{h}$，$\nabla f$为值函数$z=f(x,y)$的Jacobi矩阵，被视为一个二维向量向量到值的映射。

---

## **2.2.链式法则的Jacobi矩阵形式**

对于二维的复合值函数$z=F(u(x,y),v(x,y))$，其微分为：

$$
\text{d}z=\nabla F\cdot 
\begin{pmatrix}
\text{d}u \\
\text{d}v
\end{pmatrix}=
\nabla F \cdot
\begin{pmatrix}
\nabla u \\
\nabla v
\end{pmatrix}\cdot
\begin{pmatrix}
\text{d}x \\
\text{d}y
\end{pmatrix}=
\nabla F\cdot
\begin{pmatrix}
u_x  & u_y\\
v_x  & v_y
\end{pmatrix}\cdot
\begin{pmatrix}
\text{d}x \\
\text{d}y
\end{pmatrix}
$$

对于更为普遍的复合函数，链式法则展示了一种$n$维向量通过对应Jacobi矩阵的一种链式映射关系。

如上述的复合函数$z=F(\lambda(x,y),\mu(x,y))$，可视为下述的链式映射：

$$
\begin{pmatrix}
\text{d}x\\
\text{d}y
\end{pmatrix}
\stackrel{J_{(u,v)}}{\longrightarrow}
\begin{pmatrix}
\text{d}u\\
\text{d}v
\end{pmatrix}
\stackrel{J_F}{\longrightarrow}
\text{d}z
$$

---

## **2.3.隐函数与隐映射**

- 隐函数：

对于隐函数$f(x_1,x_2,x_3)=0$，可以确定唯一的映射：$x_i=x_i(x_j,x_k)$。对函数$f$微分：

$$
\text{d}f=\nabla f\cdot
\begin{pmatrix}
\nabla x_1 \\
\nabla x_2 \\
\nabla x_3
\end{pmatrix}\cdot
\begin{pmatrix}
\text{d}x_1 \\
\text{d}x_2 
\end{pmatrix}=
\nabla f\cdot
\begin{pmatrix}
 I\\
 \nabla x_3
\end{pmatrix}\cdot
\begin{pmatrix}
\text{d}x_1 \\
\text{d}x_2 
\end{pmatrix}
$$

解出$\nabla x_3$：

$$
\nabla f_{(x_1,x_2)}+\frac{\partial f}{\partial x_3}\nabla x_3=0
$$

即：$\nabla x_3=-{(\frac{\partial f}{\partial x_3})}^{-1}\nabla f_{(x_1,x_2)}$。

- 隐映射：

对于隐函数方程组：

$$
\left\{
\begin{matrix} 
  F_1(x,y,u,v)=0 \\  
  F_2(x,y,u,v)=0 
\end{matrix}
\right. 
$$

可以确定唯一隐映射：

$$
\left\{
\begin{matrix} 
  u = u(x,y) \\  
  v = v(x,y) 
\end{matrix}
\right. 
$$

对$F_1，F_2$微分：

$$
\left\{
\begin{matrix} 
  \text{d}F_1=\nabla F_1\cdot J_{(u,v)}\cdot\mathbf{h} \\  
  \text{d}F_2=\nabla F_2\cdot J_{(u,v)}\cdot\mathbf{h} 
\end{matrix}
\right. 
$$


不妨写作以下形式：

$$
\text{d}\mathbf{F}=
\begin{pmatrix}
\text{d}F_1 \\
\text{d}F_2
\end{pmatrix}=
\begin{pmatrix}
\nabla F_1 \\
\nabla F_2
\end{pmatrix}\cdot
J_{(u,v)}\cdot\mathbf{h}=
J_F\cdot J_{(u,v)} \cdot \mathbf{h}
$$

由于微分的形式不变性，对$\mathbf F$的微分依然可以视作对应Jacobi矩阵的链式映射法则：

$$
\begin{pmatrix}
\text{d}x\\
\text{d}y
\end{pmatrix}
\stackrel{J_{(u,v)}}{\longrightarrow}
\begin{pmatrix}
\text{d}\lambda\\
\text{d}\mu
\end{pmatrix}
\stackrel{J_F}{\longrightarrow}
\text{d}\mathbf F
$$

不妨将$J_F$分块为：$(J_{F_{(x,y)}}\ \ \ J_{F_{(u,v)}})，|J_F|\ne 0$，有：

$$
\text{d}\mathbf{F}=
\begin{pmatrix}
 J_{F_{(x,y)}} & J_{F_{(u,v)}}
\end{pmatrix}\cdot
\begin{pmatrix}
I \\
J_{(u,v)}
\end{pmatrix}\cdot
\mathbf{h}=
(J_{F_{(x,y)}}+J_{F_{(u,v)}}J_{(u,v)})\cdot\mathbf{h}
$$

解出$J_{(\lambda,\mu)}$：

$$
J_{(u,v)}=-{(J_{F_{(u,v)}})}^{-1}J_{F_{(x,y)}}
$$

---

## **2.4.曲面参数化与Jacobi行列式**

对于光滑且连续的曲面$\Omega$，其自变量$x,y$可作参数化表示：$x=P(u,v),y=Q(u,v)$，可视作$x,y$关于$u,v$的向量场$\mathbf{z}=\mathbf{F}(u,v)$。对于$\text{x}o\text{y}$平面上任意一点，$J$可视作对该点处邻域的线性变换。即：$\text{d}\mathbf{z}=J\text{d}\mathbf{h}$，此处面积微元：

$$
\text{d}\sigma=\text{d}x\text{d}y=\text{det}J\cdot\text{d}u\text{d}v
$$

1. 极坐标

$$
\left\{
\begin{matrix} 
  x = r\cos\theta \\  
  y = r\sin\theta 
\end{matrix}
\right. 
$$

可表示为：$\text{d}\mathbf{z}=J\text{d}\mathbf{h}(r,\theta)$。其中：

$$
J=\begin{pmatrix}
 \cos\theta & -r\sin\theta\\
 \sin\theta & r\cos\theta
\end{pmatrix}, \text{det}J=r
$$

故有：

$$
\text{d}\sigma=\text{d}x\text{d}y=r\text{d}r\text{d}\theta
$$

2. 球坐标

$$
\left\{
\begin{matrix} 
  x = r\sin\theta\cos\phi \\  
  y = r\sin\theta\sin\phi \\
  z = r\cos\theta 
\end{matrix}
\right. 
$$

可表示为：$\text{d}\mathbf{\omega}=J\text{d}\mathbf{h}(r,\theta,\phi)$。其中：

$$
J=\begin{pmatrix}
\sin\theta\cos\phi & r\cos\theta\cos\phi & -r\sin\theta\sin\phi\\
\sin\theta\sin\phi & r\cos\theta\sin\phi & r\sin\theta\cos\phi\\
\cos\theta & -r\sin\theta & 0
\end{pmatrix}, \text{det}J=r^2\sin\theta
$$

故有：

$$
\text{d}V=\text{d}x\text{d}y\text{d}z=r^2\sin\theta\text{d}r\text{d}\theta\text{d}\phi
$$

3. 柱坐标

$$
\left\{
\begin{matrix} 
  x = r\cos\theta \\  
  y = r\sin\theta \\
  z = z 
\end{matrix}
\right. 
$$

可表示为：$\text{d}\mathbf{\omega}=J\text{d}\mathbf{h}(r,\theta, z)$。其中：

$$
J=\begin{pmatrix}
\cos\theta & -r\sin\theta & 0\\
\sin\theta & r\cos\theta & 0\\
0 & 0 & 1
\end{pmatrix}, \text{det}J=r
$$

故有：

$$
\text{d}V=\text{d}x\text{d}y\text{d}z=r\text{d}r\text{d}\theta\text{d}z
$$

4. 锥面坐标

$$
\left\{
\begin{matrix} 
  x = r\cos\theta \\  
  y = r\sin\theta \\
  z = kr 
\end{matrix}
\right. 
$$

可表示为：$\text{d}\mathbf{\omega}=J\text{d}\mathbf{h}(r,\theta, k)$。其中：

$$
J=\begin{pmatrix}
\cos\theta & -r\sin\theta & 0\\
\sin\theta & r\cos\theta & 0\\
k & 0 & r
\end{pmatrix}, \text{det}J=r^2
$$

故有：

$$
\text{d}V=\text{d}x\text{d}y\text{d}z=r^2\text{d}r\text{d}\theta\text{d}k
$$

---
