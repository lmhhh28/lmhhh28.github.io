# **8.1.多元函数的导数与微分**

---

## **1.1.偏导数**

对于二元函数$z=f(x,y)$, 规定其在固定方向上的导数为**偏导数**。

其中在$x$方向上的偏导数记作$\frac {\partial f}{\partial x}$，在$y$方向上的偏导数记作$\frac {\partial f}{\partial y}$。

-  高阶偏导数

按照求导变量顺序的不同，存在如下偏导数：

$$
\frac {\partial ^{2} f}{\partial x^{2}}, \frac {\partial ^{2} f}{\partial y^{2}}, \frac {\partial ^{2} f}{\partial x \partial y}, \frac {\partial ^{2} f}{\partial y \partial x}
$$

有如下定理：

$$
若函数z=f(x,y)在区域D上连续且\frac {\partial ^{2} f}{\partial x \partial y}与\frac {\partial ^{2} f}{\partial y \partial x}在区域D上存在且连续，则\frac {\partial ^{2} f}{\partial x \partial y}=\frac {\partial ^{2} f}{\partial y \partial x}。
$$

---

## **1.2.全微分**

考虑曲面$z=f(x,y)$在$(x_{0}, y_{0}, z_{0})$存在切平面$\pi :Ax+By+Cz+D=0$，其法方向为：$\mathbf {r}$。则存在$\mathbf {\alpha}=(1,0,\frac {\partial f}{\partial x}|_{x=x_{0}}), \mathbf {\beta}=(0,1,\frac {\partial f}{\partial y}|_{y=y_{0}})$，使得$\mathbf {\alpha} \parallel \pi, \mathbf {\beta} \parallel \pi$，则有：

$$
\mathbf {r} = \mathbf {\alpha} \times \mathbf {\beta}=(\frac {\partial f}{\partial x}|_{x=x_{0}}, \frac {\partial f}{\partial y}|_{y=y_{0}}, -1)
$$

在$(x_{0}, y_{0}, z_{0})$处的切平面$\pi$的点法式方程为：

$$
\mathbf {r} \cdot
\begin{pmatrix}
x-x_{0} \\
y-y_{0} \\
z-z_{0}
\end{pmatrix}=0 \Longrightarrow z-z_{0}=\frac {\partial f}{\partial x}|_{x=x_{0}} (x-x_0)+\frac {\partial f}{\partial y}|_{y=y_{0}}(y-y_{0})
$$

当$x \to x_{0}, y \to y_{0}$时：

$$
\text{d}z|_{z=z_{0}}=\frac {\partial f}{\partial x}|_{x=x_{0}}\text{d}x+\frac {\partial f}{\partial y}|_{y=y_{0}}\text{d}y
$$

因此有全微分公式：

$$
\text{d}z=\frac {\partial f}{\partial x}\text{d}x+\frac {\partial f}{\partial y}\text{d}y
$$

---

## **1.3.复合多元函数的导数与微分**

如果多元函数函数$z=f(\lambda , \mu)$，其中$\lambda=\phi(t), \mu=\psi(t)$，则$z$关于$t$的导数：

$$
\frac {\text{d}z}{\text{d}t}=\frac {\partial f}{\partial \phi}\frac {\text{d}\phi}{\text{d}t}+\frac {\partial f}{\partial \psi}\frac {\text{d}\psi}{\text{d}t}
$$

若$\lambda=\phi(x, y), \mu=\psi(x, y)$，不妨令$z=g(x, y)$，则有：

$$
\text{d}z=\frac {\partial f}{\partial \phi}\text{d}\phi+\frac {\partial f}{\partial \psi}\text{d}\psi
$$

又：

$$
\text{d}\phi=\frac {\partial \phi}{\partial x}\text{d}x+\frac {\partial \phi}{\partial y}\text{d}y
$$

$$
\text{d}\psi=\frac {\partial \psi}{\partial x}\text{d}x+\frac {\partial \psi}{\partial y}\text{d}y
$$
所以：

$$
\text{d}z=(\frac {\partial f}{\partial \phi}\frac{\partial \phi}{\partial x}+\frac {\partial f}{\partial \psi}\frac{\partial \psi}{\partial x})\text{d}x+(\frac {\partial f}{\partial \phi}\frac{\partial \phi}{\partial y}+\frac {\partial f}{\partial \psi}\frac{\partial \psi}{\partial y})\text{d}y
$$

又：

$$
\text{d}z=\frac {\partial g}{\partial x}\text{d}x+\frac {\partial g}{\partial y}\text{d}y
$$
则$z=g(x, y)$偏微分：

$$
\frac {\partial g}{\partial x}=\frac {\partial f}{\partial \phi}\frac{\partial \phi}{\partial x}+\frac {\partial f}{\partial \psi}\frac{\partial \psi}{\partial x}
$$

$$
\frac {\partial g}{\partial y}=\frac {\partial f}{\partial \phi}\frac{\partial \phi}{\partial y}+\frac {\partial f}{\partial \psi}\frac{\partial \psi}{\partial y}
$$

---


## **1.4.隐函数求导**

二元隐函数通常由方程$F(x, y)=0$确定。若在$(x_{0}, y_{0})$邻域内具有连续偏导数，则有链式法则：

$$
\text{d}F(x, y(x)) = \frac {\partial F}{\partial x}\text{d}x+\frac{\partial F}{\partial y}\text{d}y
$$

又：

$$
\frac{\text{d}F(x, y)}{\text{d}x}=\frac{\partial F}{\partial x}+\frac{\partial F}{\partial y}\frac{\text{d}y}{\text{d}x}=0
$$

故隐函数方程$F(x, y)=0, y关于x的导数$为：

$$
\frac{\text{d}y}{\text{d}x}=-\frac{{F_{x}}^{'}}{{F_{y}}^{'}}
$$

推广至多元函数，例如三元隐函数方程$F(x, y, z(x, y))=0$，有链式法则：

$$
\text{d}F=\frac{\partial F}{\partial x}\text{d}x+\frac{\partial F}{\partial y}\text{d}y+\frac{\partial F}{\partial z}\text{d}z
$$

又有：$z=z(x,y)，\text{d}z=\frac{\partial z}{\partial x}\text{d}x+\frac{\partial z}{\partial y}\text{d}y$，因此：

$$
\text{d}F=(\frac{\partial F}{\partial x}+\frac{\partial F}{\partial z}\frac{\partial z}{\partial x})\text{d}x+(\frac{\partial F}{\partial y}+\frac{\partial F}{\partial z}\frac{\partial z}{\partial y})\text{d}y
$$

$$
\frac{\text{d}F}{\text{d}x}=\frac{\partial F}{\partial x}+\frac{\partial F}{\partial z}\frac{\partial z}{\partial x}=0
$$

因此有：${F_{x}}^{'}+{F_{z}}^{'}\frac{\partial z}{\partial x}=0，即：\frac{\partial z}{\partial x}=-\frac{{F_{z}}^{'}}{{F_{x}}^{'}}$。同理有：$\frac{\partial z}{\partial y}=-\frac{{F_{z}}^{'}}{{F_{x}}^{'}}$。

---

## **1.5.方向导数与梯度**

- 方向导数

讨论二元函数$z=f(x,y)$在$(x_0,y_0,z_0)$处的切平面$\pi$(若此处偏导数存在)由向量$\mathbf{\alpha}=(1,0,\frac{\partial f}{\partial x})，\mathbf{\beta}=(0,1,\frac{\partial f}{\partial y})$确定。则平行于切平面$\pi$的任意方向向量$\mathbf {l}$都可由基向量$\mathbf {\alpha}，\mathbf {\beta}$的线性组合表示：

$$
\mathbf{l}=\lambda \mathbf{\alpha}+\mu \mathbf{\beta}=(\lambda,\mu,\lambda\frac{\partial f}{\partial x}+\mu \frac{\partial f}{\partial y})
$$

定义$z=f(x,y)$在$\mathbf{l}$方向的方向导数：

$$
\frac{\partial f}{\partial l}=\frac{\lambda}{\sqrt{\lambda^2+\mu^2}}\frac{\partial f}{\partial x}+\frac{\mu}{\sqrt{\lambda^2+\mu^2}}\frac{\partial f}{\partial y}
$$

由定义可知，$z=f(x,y)$在$x$轴方向的方向导数为$\frac{\partial f}{\partial x}$，在$y$轴方向的方向导数为$\frac{\partial f}{\partial y}$。描述了$z=f(x,y)的(x_0,y_0,z_0)处\mathbf{l}$方向上的变化量


- 梯度

不妨将函数$z=f(x,y)$的$(x_0,y_0,z_0)$点在$\mathbf{l}$方向上的方向导数视作以下内积形式：

$$
\frac{\partial f}{\partial l}=(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y})\cdot(\frac{\lambda}{\sqrt{\lambda^2+\mu^2}},\frac{\mu}{\sqrt{\lambda^2+\mu^2}})^T=(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y})\cdot \mathbf{e_l}
$$

其中$\mathbf{e_l}$是$(x_0,y_0,z_0)$处$\mathbf{l}$方向上的单位向量。定义函数$z=f(x,y)$的点$(x_0,y_0,z_0)$处的梯度为：

$$
\nabla f(x,y)=(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y})
$$

重新审视方向导数的内积形式：

$$
\frac{\partial f}{\partial l}=|\nabla f(x,y)|\cdot |\mathbf{e_l}|\cos{\theta}
$$

其中$\theta$是单位方向向量$\mathbf{e_l}$与梯度$\nabla f(x,y)$的夹角。

要使在$\mathbf{l}$方向上的变化率最大，$\cos{\theta}=1$，即方向单位向量$\mathbf{e_l}$与梯度$\nabla f(x,y)$平行。

---