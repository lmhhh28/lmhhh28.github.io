# **11.Theory Related to Linear Differential Equation**

---

## **11.1.Linear Properties of Differential Operator**

设$V$是所有在某区间$I\subseteq\mathbb{R}$上可微函数的集合，构造可微函数向量$\mathbf{f}=(f_1, f_2, \cdots, f_n)$，所有这样的可微函数向量组成的集合记作$V^n$。

$V_n$是一个向量空间，其加法与数乘的定义：

1. $\mathbf{f}+\mathbf{g}=(f_1+g_1, f_2+g_2, \cdots, f_n+g_n)$
2. $c\cdot\mathbf{f}=(cf_1, cf_2, \cdots, cf_n)$

考虑$V^n$上的微分算子$\boldsymbol{D}(\mathbf{f})=(\frac{\text{d}f_1}{\text{d}x},\frac{\text{d}f_2}{\text{d}x},\cdots, \frac{\text{d}f_n}{\text{d}x})$，其满足以下性质：

1. $\boldsymbol{D}(\mathbf{f}+\mathbf{g})=\frac{\text{d}}{\text{d}x}(\mathbf{f}+\mathbf{g})=\frac{\text{d}\mathbf{f}}{\text{d}x}+\frac{\text{d}\mathbf{g}}{\text{d}x}=\boldsymbol{D}(\mathbf{f})+\boldsymbol{D}(\mathbf{g})$
2. $\boldsymbol{D}(cf)=\frac{\text{d}}{\text{d}x}(cf)=c\frac{\text{d}f}{\text{d}x}=c\boldsymbol{D}(f)$

因此，微分算子$\boldsymbol{D}$为$V^n\to V^n$的线性映射。

不难证明，对$\mathbf{f}$的矩阵作用$\boldsymbol{A}(x)$是线性映射。考虑$V^n$上的映射$\boldsymbol{L}=\boldsymbol{D}+\boldsymbol{A}(x)$，由于线性映射的加法保持性，算子$\boldsymbol{L}$依然是线性映射。对于线性齐次微分方程

$$
\boldsymbol{L}(\mathbf{y})=\frac{\text{d}}{\text{d}x}\mathbf{y}+\boldsymbol{A}(x)\mathbf{y}=0
$$

的解基满足$\boldsymbol{L}(\mathbf{y_0})=0,\boldsymbol{L}(\mathbf{y_1})=0\cdots,\boldsymbol{L}(\mathbf{y_n})=0$。其解基的线性组合$\mathbf{u}=c_0\cdot\mathbf{y_0}+c_1\cdot\mathbf{y_1}+\cdots+c_n\cdot\mathbf{y_n}$依然满足$\boldsymbol{L}(\mathbf{u})=0$。解基的线性组合为此微分方程的**通解**。

对于非齐次线性微分方程：

$$
\boldsymbol{L}(\mathbf{y})=\frac{\text{d}}{\text{d}x}\mathbf{y}+\boldsymbol{A}(x)\mathbf{y}=\mathbf{f}
$$

有**特解**满足$\boldsymbol{L}(\mathbf{u}^*)=\mathbf{f}$，同时有通解满足$\boldsymbol{L}(\mathbf{u})=0$。由于$\boldsymbol{L}$为$V^n\to V^n$的线性映射，有：$\boldsymbol{L}(\mathbf{u}+\mathbf{u}^*)=0$。因此方程的解为齐次线性方程的通解与特解的叠加：

$$
\mathbf{y}=\mathbf{u}+\mathbf{u}^*
$$

---

## **11.2.Solution Space & Martix**

有齐次线性微分方程：

$$
\frac{\text{d}}{\text{d}x}\mathbf{y}=\boldsymbol{A}(x)\mathbf{y}
$$

我们令其在区间$(a,b)$上的所有解所组成的集合为$\mathcal{S}$，由齐次线性微分方程解的叠加定理，集合$\mathcal{S}$为线性空间。

对于任意的初始条件$(x_0, \mathbf{y}(x_0))$，<u>**都有唯一确定**</u>的$\mathbf{y}(x)$与之对应。由于$\mathbf{y}(x_0)\subseteq\mathbb{R^n}$，我们确定映射$H:\mathcal{S}\to\mathbb{R^n}$。显然，$H$为**双射**。

现在证明$H$为线性映射，即证明$H^{-1}$也为线性映射。

1. $H^{-1}(\mathbf{f}+\mathbf{g})=H^{-1}(\mathbf{f})+H^{-1}(\mathbf{g})$
2. $H^{-1}(c\cdot\mathbf{f})=cH^{-1}(\mathbf{f})$

由于$\mathcal{S}$是线性空间，$\mathbf{f}\subseteq\mathcal{S},\mathbf{g}\subseteq\mathcal{S}$，则$\mathbf{f}+\mathbf{g}\subseteq\mathcal{S}，c\cdot\mathbf{f}\subseteq\mathcal{S}$。即$1,2$成立，$H:\mathcal{S}\to\mathbb{R^n}$为线性同构映射，两者拥有相同的基底数，即：$\text{dim}\mathcal{S}=\text{dim}\mathbb{R^n}=n$。

因此，$n$阶齐次线性微分方程的解空间$\mathcal{S}$是$n$维的，即其有$n$个**线性无关**的解。

我们将这$n$个基解的线性组合写作解矩阵的形式：

$$
\mathbf{u}=c_1\mathbf{y_1}+\cdots+c_n\mathbf{y_n}=\boldsymbol{\Phi}(x)\mathbf{c}
$$

满足：

$$
\frac{\text{d}}{\text{d}x}\boldsymbol{\Phi}(x)=\boldsymbol{A}(x)\cdot\boldsymbol{\Phi}(x)
$$

不难证明，对于任意非奇异常数矩阵$\mathbf{C}$，$\boldsymbol{\Phi}(x)\cdot\mathbf{C}$也为此齐次线性微分方程的解矩阵。

对于非齐次线性微分方程：

$$
\frac{\text{d}}{\text{d}x}\mathbf{y}=\boldsymbol{A}(x)\mathbf{y}+\mathbf{f}
$$

有通解$\mathbf{u}=\boldsymbol{\Phi}(x)\mathbf{c}$与特解$\mathbf{u^*}=\boldsymbol{\Phi}(x)\mathbf{c}(x)$。对于特解$\mathbf{u^*}$，有：

$$
\frac{\text{d}}{\text{d}x}\mathbf{c}'(x)=\boldsymbol{\Phi}^{-1}(x)\cdot\mathbf{f}
$$

由此可以确定非齐次线性微分方程解的具体结构：

$$
\boldsymbol{Y}(x)=\boldsymbol{\Phi}(x)(\mathbf{c}+\int_{x_0}^x\boldsymbol{\Phi}^{-1}(s)\cdot\mathbf{f}\text{d}s)
$$

由于特解的形式，我们找到的解组需要保证$\text{Wrongsky}$行列式$W(x)=\text{det}\boldsymbol{\Phi}(x)\ne0$，即解组线性无关。若基解线性相关，则不足以张成整个解空间$\mathcal{S}$，此时无法找出特解与通解的完全形式。

对于$\text{Wrongsky}$行列式$W(x)=\text{det}\boldsymbol{\Phi}(x)$，我们不加证明地给出$\text{Liouville}$公式：

$$
\frac{\text{d}}{\text{d}x}W(x)=\text{tr}[\boldsymbol{A}(x)]W(x)
$$

解得：

$$
W(x)=Ce^{\int\text{tr}[\boldsymbol{A}(x)]\text{d}x},C\ne 0
$$

---

## **11.3.Matrix Exponential**

Suppose a 常系数矩阵多项式：

$$
e^{x\boldsymbol{A}}=\frac{x^0\boldsymbol{A}^0}{0!}+\frac{x^1\boldsymbol{A}^1}{1!}+\cdots+\frac{x^n\boldsymbol{A}^n}{n!}
$$

满足：

$$
\frac{\text{d}}{\text{d}x}e^{x\boldsymbol{A}}=\boldsymbol{A}(\boldsymbol{I}+x\boldsymbol{A}+\cdots+\frac{x^n\boldsymbol{A}^n}{n!})=\boldsymbol{A}e^{x\boldsymbol{A}}
$$

可以断定，常系数齐次线性微分方程$\frac{\text{d}}{\text{d}x}\mathbf{y}=\boldsymbol{A}\mathbf{y}$的解矩阵：

$$
\boldsymbol{\Phi}(x)=\boldsymbol{I}+x\boldsymbol{A}+\cdots+\frac{x^n\boldsymbol{A}^n}{n!}=e^{x\boldsymbol{A}}
$$

常系数非齐次线性微分方程$\frac{\text{d}}{\text{d}x}\mathbf{y}=\boldsymbol{A}\mathbf{y}+\mathbf{f}$在区间$(a,b)$上的解矩阵：

$$
\boldsymbol{Y}(x)=e^{x\boldsymbol{A}}\mathbf{c}+\int_{x_0}^xe^{(x-s)\boldsymbol{A}}\cdot\mathbf{f}\text{d}s
$$

矩阵指数$e^{\boldsymbol{A}}$满足以下性质：

1. 若矩阵$\boldsymbol{A},\boldsymbol{B}$是可交换的，则$e^{\boldsymbol{A}+\boldsymbol{B}}=e^{\boldsymbol{A}}e^{\boldsymbol{B}}$。常系数非齐次线性微分方程在
2. 对于任意的$\boldsymbol{A}$，$e^{\boldsymbol{A}}$是可逆的，且$(e^{\boldsymbol{A}})^{-1}=e^{-\boldsymbol{A}}$
3. 若$\boldsymbol{P}$是任意非奇异$n$阶矩阵，则$e^{\boldsymbol{P}\boldsymbol{\Lambda}\boldsymbol{P}^{-1}}=\boldsymbol{P}e^{\boldsymbol{\Lambda}}\boldsymbol{P}^{-1}$

任意矩阵$\boldsymbol{A}$可转换为$\text{Jordan}$标准型：$\boldsymbol{A}=\boldsymbol{P}\boldsymbol{J}\boldsymbol{P}^{-1}$，对于指数矩阵$e^{x\boldsymbol{A}}$，则有：

$$
e^{x\boldsymbol{A}}=e^{x\boldsymbol{P}\boldsymbol{J}\boldsymbol{P}^{-1}}=\boldsymbol{P}e^{x\boldsymbol{J}}\boldsymbol{P}^{-1}
$$

其中：

$$
\boldsymbol{J} = \begin{pmatrix} 
\boldsymbol{J}_1 & & & \\
& \boldsymbol{J}_2 & & \\
& & \ddots & \\
& & & \boldsymbol{J}_m 
\end{pmatrix}
$$

为$\text{Jordan}$标准型。$\boldsymbol{J}_i$为$\text{Jordan}$块：

$$
\boldsymbol{J}_i = \begin{pmatrix} 
\lambda_i & 1 & & \\
& \lambda_i & \ddots & \\
& & \ddots & 1 \\
& & & \lambda_i 
\end{pmatrix}= \begin{pmatrix} 
\lambda_i & & & \\
& \lambda_i & & \\
& & \ddots & \\
& & & \lambda_i 
\end{pmatrix} + \begin{pmatrix} 
0 & 1 & & \\
& 0 & \ddots & \\
& & \ddots & 1 \\
& & & 0 
\end{pmatrix}
$$

又：

$$
e^{x\boldsymbol{J}}=\boldsymbol{I}+x\boldsymbol{J}+\cdots+\frac{x^n\boldsymbol{J}^n}{n!} = \begin{pmatrix} 
\mathrm{e}^{x\boldsymbol{J}_1} & & & \\
& \mathrm{e}^{x\boldsymbol{J}_2} & & \\
& & \ddots & \\
& & & \mathrm{e}^{x\boldsymbol{J}_m} 
\end{pmatrix}
$$

其中：

$$
\mathrm{e}^{x\boldsymbol{J}_i} = \mathrm{e}^{\lambda_i x} \left\{ \boldsymbol{I} + x\begin{pmatrix} 
0 & 1 & & & \\
& \ddots & \ddots & & \\
& & \ddots & \ddots & \\
& & & \ddots & 1 \\
& & & & 0 
\end{pmatrix} + \cdots + \frac{x^{n_i - 1}}{(n_i - 1)!}\begin{pmatrix} 
0 & \cdots & \cdots & 0 & 1 \\
& 0 & \cdots & \cdots & 0 \\
& & \ddots & & \vdots \\
& & & \ddots & \vdots \\
& & & & 0 
\end{pmatrix} \right\}
$$

即：

$$
\mathrm{e}^{x\boldsymbol{J}_i} = \mathrm{e}^{\lambda_i x} \begin{pmatrix} 
1 & x & \frac{x^2}{2!} & \cdots & \frac{x^{n_i - 1}}{(n_i - 1)!} \\
& 1 & x & \cdots & \frac{x^{n_i - 2}}{(n_i - 2)!} \\
& & \ddots & \ddots & \vdots \\
& & & \ddots & x \\
& & & & 1 
\end{pmatrix}
$$

所以最终解矩阵的形式：

$$
\boldsymbol{\Phi}(x)=e^{x\boldsymbol{A}}\boldsymbol{P}=\boldsymbol{P}e^{x\boldsymbol{J}}
$$

得到通解的具体形式：

$$
\mathbf{y}=e^{\lambda_1x}\boldsymbol{P}_1(x)+e^{\lambda_2x}\boldsymbol{P}_2(x)+\cdots+e^{\lambda_nx}\boldsymbol{P}_n(x)=\sum_{m=1}^{n} e^{\lambda_mx}\boldsymbol{P}_m(x)
$$

其中：

$$
\boldsymbol{P}_i(x)=\boldsymbol{C}_i
\begin{pmatrix}
1 \\
x \\
x^2 \\
\vdots \\
x^{n_i-1}
\end{pmatrix}=\boldsymbol{C}_i\mathbf{p}(x)
$$

$\boldsymbol{C}_i$为常系数矩阵，由初始值组唯一确定。

---

## **11.4.高阶线性微分方程**

对于高阶线性微分方程：

$$
y^{(n)} + a_1(x) y^{(n-1)} + \cdots + a_{n-1}(x) y' + a_n(x) y = f(x)
$$

写成$\frac{\text{d}}{\text{d}x}\mathbf{y}=\boldsymbol{A}(x)\mathbf{y}+\mathbf{f}$形式：

$$
\begin{pmatrix}
y' \\
y'' \\
\vdots  \\
y^{(n-1)} \\
y^{(n)}
\end{pmatrix}=
\begin{pmatrix} 
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & & \vdots \\
0 & 0 & 0 & \cdots & 1 \\
-a_{n}(x) & -a_{n-1}(x) & -a_{n-2}(x) & \cdots & -a_1(x) 
\end{pmatrix}
\begin{pmatrix}
y \\
y' \\
\vdots  \\
y^{(n-2)} \\
y^{(n-1)}
\end{pmatrix}+
\begin{pmatrix}
0 \\
0 \\
\vdots  \\
0 \\
f(x)
\end{pmatrix}
$$

对于常系数齐次线性微分方程$y^{(n)} + a_1 y^{(n-1)} + \cdots + a_{n-1} y' + a_n y = 0$，将$\boldsymbol{A}$化为$\text{Jordan}$阵，特征方程为：

$$
\det[\lambda \boldsymbol{I} - \boldsymbol{A}] = 
\begin{vmatrix} 
\lambda & -1 & 0 & \cdots & 0 & 0 \\
0 & \lambda & -1 & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & & \vdots & \vdots \\
0 & 0 & 0 & \cdots & \lambda & -1 \\
a_{n} & a_{n-1} & a_{n-2} & \cdots & a_2 & \lambda + a_1 
\end{vmatrix}=\lambda^n + a_1 \lambda^{n-1} + \cdots + a_{n-1} \lambda + a_n =0
$$

Suppose $\boldsymbol{A}$的代数重数为$n$，利用11.3中的结论，通解的具体形式为：

$$
\mathbf{y}=\sum_{m=1}^{n} e^{\lambda_mx}\boldsymbol{P}_m(x)
$$

我们只关心$\mathbf{y}$的第一个维度，即$y$：

$$
y=\sum_{m=1}^{n} e^{\lambda_mx}\mathbf{p}_m(x)
$$

其中$\mathbf{p}_m(x)$为$x$的$n_i-1$次多项式：

$$
\mathbf{p}_i(x)=\mathbf{c}_i\cdot
\begin{pmatrix}
1 \\
x \\
x^2 \\
\vdots \\
x^{n_i-1}
\end{pmatrix}=\mathbf{c}_i\cdot\mathbf{p}(x)
$$

$\mathbf{c}_i$为常系数行向量，由初值唯一确定。

对于二阶非常系数情况，即$y''+p(x)y'+q(x)y=0$，已知$\varphi$满足$\varphi''+p(x)\varphi'+q(x)\varphi=0$。由于解空间$\mathcal{S}$是二维的，因此必定存在另一线性无关解$y$，有$\text{Liouville}$公式：

$$
W(x)=
\begin{vmatrix}
\varphi & y\\
\varphi' & y'
\end{vmatrix}=Ce^{-\int p(x)\text{d}x},C\ne 0
$$

有：

$$
\frac{\varphi y'-y\varphi'}{\varphi^2}=\frac{C}{\varphi^2}e^{-\int p(x)\text{d}x}
$$

即：

$$
\frac{\text{d}}{\text{d}x}(\frac{y}{\varphi})=\frac{C}{\varphi^2}e^{-\int p(x)\text{d}x}
$$

由此确定另一线性无关解$y$：

$$
y = \varphi(x) \left[ C_1 + C_2 \int_{x_0}^{x} \frac{1}{\varphi^2(s)} \mathrm{e}^{-\int_{x_0}^{s} p(t) \,\mathrm{d}t} \,\mathrm{d}s \right]
$$

对于更一般的非齐次情况：$y''+p(x)y'+q(x)y=f(x)$，写作$\frac{\text{d}}{\text{d}x}\mathbf{y}=\boldsymbol{A}(x)\mathbf{y}+\mathbf{f}$形式：

$$
\begin{pmatrix}
y' \\
y''
\end{pmatrix}=
\begin{pmatrix}
0 &1 \\
 -q &-p
\end{pmatrix}
\begin{pmatrix}
y \\
y'
\end{pmatrix}+
\begin{pmatrix}
0 \\
f
\end{pmatrix}
$$

可以确定解矩阵：

$$
\boldsymbol{\Phi}(x)=
\begin{pmatrix}
\varphi_1 & \varphi_2\\
\varphi_1' & \varphi_2'
\end{pmatrix}
$$

利用常数变易法，令通解$\varphi^*=\boldsymbol{\Phi}(x)\mathbf{c}(x)$，代入原方程：

$$
\mathbf{c}'(x)\boldsymbol{\Phi}(x)=
\begin{pmatrix}
0 \\
f
\end{pmatrix}
$$

即：

$$
\begin{pmatrix}
\varphi_1 & \varphi_2\\
\varphi_1' & \varphi_2'
\end{pmatrix}
\begin{pmatrix}
c_1' \\
c_2'
\end{pmatrix}=
\begin{pmatrix}
0 \\
f
\end{pmatrix}
$$

解得：

$$
c_1'(x) = -\frac{\varphi_2(x) f(x)}{W(x)}, \quad c_2'(x) = \frac{\varphi_1(x) f(x)}{W(x)}
$$

得到方程的通解：

$$
y = C_1\varphi_1(x) + C_2\varphi_2(x) + \int_{x_0}^{x} \frac{\varphi_1(s)\varphi_2(x) - \varphi_1(x)\varphi_2(s)}{\varphi_1(s)\varphi_2'(s) - \varphi_2(s)\varphi_1'(s)} f(s) \,\mathrm{d}s
$$

---





