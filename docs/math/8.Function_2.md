# **2.Jacobi矩阵与隐映射复合**

---

## **2.1.向量集映射与Jacobi矩阵

考虑向量集函数$\mathbf{z}=f(\mathbf{v})，\mathbf{v}=(x,y)^{\mathbf{T}}$在$(x_0,y_0)$处微分：

$$
f(\mathbf v+\mathbf h)-f(\mathbf v)=J\cdot\mathbf h+o(||\mathbf h||)，\mathbf h \to \mathbf 0
$$

其中$o(||\mathbf h||)$为$||\mathbf h||$的高阶无穷小，因此$f(\mathbf v)$在$(x_0,y_0)$处任意方向$\mathbf h$的增量可近似于增量$\mathbf h$的线性函数：

$$
df(\mathbf v)=J\cdot\mathbf h
$$

对于更为具体的向量集函数$F(x,y)=(P(x,y),Q(x,y))^{\mathbf T}$，其微分可表示为：

$$
dF(x,y)=
\begin{pmatrix}
 dP\\
 dQ
\end{pmatrix}
=\begin{pmatrix}
 \nabla P\\
 \nabla Q
\end{pmatrix}\cdot\mathbf h=
\begin{pmatrix}
 \frac{\partial P}{\partial x} & \frac{\partial P}{\partial y}\\
 \frac{\partial Q}{\partial x} & \frac{\partial Q}{\partial x}
\end{pmatrix}\cdot\mathbf{h}
$$

因此我们确定二维向量集函数$\mathbf{z}=f(\mathbf{v})$的Jacobi矩阵：

$$
J=\begin{pmatrix}
 \frac{\partial P}{\partial x} & \frac{\partial P}{\partial y}\\
 \frac{\partial Q}{\partial x} & \frac{\partial Q}{\partial x}
\end{pmatrix}
$$

对于二维值函数$z=f(x,y)$，有$dz=\nabla f\cdot\mathbf{h}$，$\nabla f$为值函数$z=f(x,y)$的Jacobi矩阵，被视为一个二维向量向量到值的映射。

---

## **2.2.链式法则的Jacobi矩阵形式**

对于二维的复合值函数$z=F(\lambda(x,y),\mu(x,y))$，其微分为：

$$
dz=\nabla F\cdot 
\begin{pmatrix}
d\lambda \\
d\mu
\end{pmatrix}=
\nabla F \cdot
\begin{pmatrix}
\nabla \lambda \\
\nabla \mu
\end{pmatrix}\cdot
\begin{pmatrix}
dx \\
dy
\end{pmatrix}=
\nabla F\cdot
\begin{pmatrix}
\frac{\partial \lambda}{\partial x}  & \frac{\partial \lambda}{\partial y}\\
\frac{\partial \mu}{\partial x}  & \frac{\partial \mu}{\partial y}
\end{pmatrix}\cdot
\begin{pmatrix}
dx \\
dy
\end{pmatrix}
$$

对于更为普遍的复合函数，链式法则展示了一种$n$维向量通过对应Jacobi矩阵的一种链式映射关系。

如上述的复合函数$z=F(\lambda(x,y),\mu(x,y))$，可视为下述的链式映射：

$$
\begin{pmatrix}
dx\\
dy
\end{pmatrix}
\stackrel{J_{(\lambda,\mu)}}{\longrightarrow}
\begin{pmatrix}
d\lambda\\
d\mu
\end{pmatrix}
\stackrel{J_F}{\longrightarrow}
dz
$$

---

## **2.3.隐函数与隐映射**

- 隐函数：

对于隐函数$f(x_1,x_2,x_3)=0$，可以确定唯一的映射：$x_i=x_i(x_j,x_k)$。对函数$f$微分：

$$
df=\nabla f\cdot
\begin{pmatrix}
\nabla x_1 \\
\nabla x_2 \\
\nabla x_3
\end{pmatrix}\cdot
\begin{pmatrix}
dx_1 \\
dx_2 
\end{pmatrix}=
\nabla f\cdot
\begin{pmatrix}
 I\\
 \nabla x_3
\end{pmatrix}\cdot
\begin{pmatrix}
dx_1 \\
dx_2 
\end{pmatrix}
$$

解出$\nabla x_3$：

$$
\nabla f_{(x_1,x_2)}+\frac{\partial f}{\partial x_3}\nabla x_3=0
$$

即：$\nabla x_3=-{(\frac{\partial f}{\partial x_3})}^{-1}\nabla f_{(x_1,x_2)}$。

- 隐映射：

对于隐函数方程组：

$$
\left\{
\begin{matrix} 
  F_1(x,y,\lambda,\mu)=0 \\  
  F_2(x,y,\lambda,\mu)=0 
\end{matrix}
\right. 
$$

可以确定唯一隐映射：

$$
\left\{
\begin{matrix} 
  \lambda = \lambda(x,y) \\  
  \mu = \mu(x,y) 
\end{matrix}
\right. 
$$

对$F_1，F_2$微分：

$$
\left\{
\begin{matrix} 
  dF_1=\nabla F_1\cdot J_{(\lambda,\mu)}\cdot\mathbf{h} \\  
  dF_2=\nabla F_2\cdot J_{(\lambda,\mu)}\cdot\mathbf{h} 
\end{matrix}
\right. 
$$


不妨写作以下形式：

$$
d\mathbf{F}=
\begin{pmatrix}
dF_1 \\
dF_2
\end{pmatrix}=
\begin{pmatrix}
\nabla F_1 \\
\nabla F_2
\end{pmatrix}\cdot
J_{(\lambda,\mu)}\cdot\mathbf{h}=
J_F\cdot J_{(\lambda,\mu)} \cdot \mathbf{h}
$$

由于微分的形式不变性，对$\mathbf F$的微分依然可以视作对应Jacobi矩阵的链式映射法则：

$$
\begin{pmatrix}
dx\\
dy
\end{pmatrix}
\stackrel{J_{(\lambda,\mu)}}{\longrightarrow}
\begin{pmatrix}
d\lambda\\
d\mu
\end{pmatrix}
\stackrel{J_F}{\longrightarrow}
d\mathbf F
$$

不妨将$J_F$分块为：$(J_{F_{(x,y)}}\ \ \ J_{F_{(\lambda,\mu)}})，|J_F|\ne 0$，有：

$$
d\mathbf{F}=
\begin{pmatrix}
 J_{F_{(x,y)}} & J_{F_{(\lambda,\mu)}}
\end{pmatrix}\cdot
\begin{pmatrix}
I \\
J_{(\lambda,\mu)}
\end{pmatrix}\cdot
\mathbf{h}=
(J_{F_{(x,y)}}+J_{F_{(\lambda,\mu)}}J_{(\lambda,\mu)})\cdot\mathbf{h}
$$

解出$J_{(\lambda,\mu)}$：

$$
J_{(\lambda,\mu)}=-{(J_{F_{(\lambda,\mu)}})}^{-1}J_{F_{(x,y)}}
$$

---



